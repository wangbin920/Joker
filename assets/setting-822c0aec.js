import{J,o as V,d as F,f as g,n as $,j as _,a as K,l as N,b as f,c as h,w as y,g as T,q as M,u as A,s as r,e as k,p as B,i as L}from"./index-3960a90f.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import{a as E}from"./axios-78d57de0.js";const O={editor:null,name:"json-editor-vue",internalChange:!1,props:{modelValue:Object|Number|Array,options:Object,currentMode:{type:String,default:"code"},modeList:{type:Array,default:()=>["tree","code","form","text","view"]},language:{type:String,default:"en"}},data(){return{json:this.modelValue,expandedModes:["tree","view","form"],isFullScreen:!1,hasLogo:!0,showFullScreen:!1}},watch:{modelValue:{immediate:!0,deep:!0,handler(t){this.internalChange||(this.setEditorContent(t),this.$nextTick(()=>{this.expandAll()}))}}},mounted(){this.init();const t=document.querySelector(".jsoneditor-menu .jsoneditor-poweredBy");this.hasLogo=t&&window.getComputedStyle(t).display!=="none",this.showFullScreen=!0},unmounted(){var t;(t=this.editor)==null||t.destroy(),this.editor=null},methods:{toggleFullScreen(){this.isFullScreen=!this.isFullScreen,this.$nextTick(()=>{const t=new Event("resize");window.dispatchEvent(t)})},init(){const{currentMode:t,modeList:s,options:n}=this,c=()=>{const o=a=>{this.json=a,this.$emit("update:modelValue",a),this.$emit("change",a),this.internalChange=!0,this.$nextTick(()=>{this.internalChange=!1})};if(!this.editor.getText()){o("");return}try{const a=this.editor.get();o(a)}catch{}},i=()=>{this.expandAll()},l=(o,e,a)=>{this.$emit("textSelectionChange",this.editor,o,e,a)},d=(o,e)=>{this.$emit("selectionChange",this.editor,o,e)},v=(o,e,a)=>{this.$emit("colorPicker",this.editor,o,e,a)},p=({target:o})=>{this.$emit("focus",this.editor,o)},S=({target:o})=>{this.$emit("blur",this.editor,o)},b=o=>{this.$emit("validationError",this.editor,o)},x={...n,indentation:2,language:this.language,mode:t,modes:s,onChange:c,onModeChange:i,onTextSelectionChange:l,onSelectionChange:d,onColorPicker:v,onFocus:p,onBlur:S,onValidationError:b};this.editor=new J(this.$refs.jsonEditorVue,x,this.json)},expandAll(){var t,s;this.expandedModes.includes((t=this.editor)==null?void 0:t.getMode())&&((s=this.editor)==null||s.expandAll())},setEditorContent(t){var s;(s=this.editor)==null||s.set(t)}}},P={ref:"jsonEditorVue",class:"json-editor-vue"};function U(t,s,n,c,i,l){return V(),F("div",{class:$(["container",{"full-screen-container":i.isFullScreen}])},[g("div",P,null,512),g("div",{class:$(["full-screen",{show:i.showFullScreen,right:!i.hasLogo}]),onClick:s[0]||(s[0]=(...d)=>l.toggleFullScreen&&l.toggleFullScreen(...d))},null,2)],2)}const w=D(O,[["render",U],["__scopeId","data-v-71f05bd7"]]);w.install=function(s){s.component(w.name,w)};const q=t=>(B("data-v-7c858e72"),t=t(),L(),t),z={class:"setting-container"},G={class:"setting-header"},H=q(()=>g("h1",{class:"setting-title"},"âš™ï¸ æ•°æ®ç®¡ç†",-1)),W={class:"editor-wrapper"},Q={class:"editor-actions"},R={__name:"setting",setup(t){const s=_("daluan"),n=_([]),c=_(!1),i=_(!1),l=K(()=>window.location.pathname.startsWith("/Joker/")),d=()=>s.value==="daluan"?"data_daluan":"data_xiangqi",v=()=>{const e="/Joker/";return s.value==="daluan"?e+"data.json":e+"data2.json"},p=async()=>{i.value=!0;try{const e=d(),a=localStorage.getItem(e);if(a)n.value=JSON.parse(a),r.success("æ•°æ®åŠ è½½æˆåŠŸï¼ˆå·²ä¿®æ”¹ï¼‰");else{const u=v(),m=await E.get(u+"?t="+Date.now());n.value=m.data.list,r.success("æ•°æ®åŠ è½½æˆåŠŸï¼ˆåˆå§‹æ•°æ®ï¼‰")}}catch(e){r.error("æ•°æ®åŠ è½½å¤±è´¥: "+e.message),console.error("åŠ è½½æ•°æ®å¤±è´¥:",e)}finally{i.value=!1}},S=async()=>{if(l.value){c.value=!0;try{const e=d();localStorage.setItem(e,JSON.stringify(n.value)),window.dispatchEvent(new CustomEvent("dataUpdated",{detail:{type:s.value,data:n.value}})),r.success("æ•°æ®å·²ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨")}catch(e){r.error("ä¿å­˜å¤±è´¥: "+e.message)}finally{c.value=!1}return}c.value=!0;try{const e=s.value==="daluan"?"data.json":"data2.json",u=!1?`http://localhost:3001/api/${e}`:`/api/${e}`;await E.put(u,{list:n.value});const m=d();localStorage.setItem(m,JSON.stringify(n.value)),window.dispatchEvent(new CustomEvent("dataUpdated",{detail:{type:s.value,data:n.value}})),r.success("æ•°æ®ä¿å­˜æˆåŠŸï¼å·²åŒæ­¥åˆ°æ–‡ä»¶ç³»ç»Ÿ")}catch(e){r.error("æ•°æ®ä¿å­˜å¤±è´¥: "+e.message),console.error("ä¿å­˜æ•°æ®å¤±è´¥:",e)}finally{c.value=!1}},b=()=>{p()},x=async()=>{i.value=!0;try{const e=d();localStorage.removeItem(e);const a=v(),u=await E.get(a+"?t="+Date.now());n.value=u.data.list,r.success("å·²é‡ç½®ä¸ºåŽŸå§‹æ•°æ®")}catch(e){r.error("é‡ç½®å¤±è´¥: "+e.message),console.error("é‡ç½®æ•°æ®å¤±è´¥:",e)}finally{i.value=!1}},o=()=>{p()};return N(()=>{p()}),(e,a)=>{const u=f("a-tab-pane"),m=f("a-tabs"),C=f("a-button"),I=f("a-alert");return V(),F("div",z,[g("div",G,[H,h(m,{activeKey:s.value,"onUpdate:activeKey":a[0]||(a[0]=j=>s.value=j),onChange:o,class:"data-tabs"},{default:y(()=>[h(u,{key:"daluan",tab:"ðŸŽ® å¤§ä¹±æ–—æ•°æ®"}),h(u,{key:"xiangqi",tab:"â™Ÿï¸ ä¸‹æ£‹æ•°æ®"})]),_:1},8,["activeKey"])]),g("div",W,[g("div",Q,[h(C,{type:"primary",onClick:S,loading:c.value,disabled:l.value},{default:y(()=>[k(" ðŸ’¾ ä¿å­˜æ•°æ® ")]),_:1},8,["loading","disabled"]),h(C,{onClick:b,loading:i.value},{default:y(()=>[k(" ðŸ”„ é‡æ–°åŠ è½½ ")]),_:1},8,["loading"]),h(C,{danger:"",onClick:x,loading:i.value,disabled:l.value},{default:y(()=>[k(" ðŸ”™ é‡ç½®ä¸ºåŽŸå§‹æ•°æ® ")]),_:1},8,["loading","disabled"])]),l.value?(V(),T(I,{key:0,type:"warning",message:"GitHub Pages éƒ¨ç½²ç‰ˆæœ¬",description:"å½“å‰ä¸ºé™æ€éƒ¨ç½²ç‰ˆæœ¬ï¼Œæ•°æ®ä¿®æ”¹ä»…ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œä¸ä¼šåŒæ­¥åˆ°æœåŠ¡å™¨ã€‚å»ºè®®ä½¿ç”¨æœ¬åœ°éƒ¨ç½²ç‰ˆæœ¬ä»¥èŽ·å¾—å®Œæ•´åŠŸèƒ½ã€‚","show-icon":"",closable:"",style:{"margin-bottom":"16px"}})):M("",!0),h(A(w),{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=j=>n.value=j),class:"editor"},null,8,["modelValue"])])])}}},ee=D(R,[["__scopeId","data-v-7c858e72"]]);export{ee as default};
