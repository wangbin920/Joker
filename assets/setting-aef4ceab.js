import{J,o as E,d as $,f as p,n as F,j as y,a as K,l as T,b as w,c as g,w as b,g as M,q as N,u as B,s as r,e as k,p as L,i as O}from"./index-0c77e041.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";import{a as V}from"./axios-21b846bc.js";const A={editor:null,name:"json-editor-vue",internalChange:!1,props:{modelValue:Object,options:Object,currentMode:{type:String,default:"code"},modeList:{type:Array,default:()=>["tree","code","form","text","view"]},language:{type:String,default:"en"}},data(){return{json:this.modelValue,expandedModes:["tree","view","form"],isFullScreen:!1,hasLogo:!0,showFullScreen:!1}},watch:{modelValue:{immediate:!0,deep:!0,handler(t){this.internalChange||(this.setEditorContent(t),this.$nextTick(()=>{this.expandAll()}))}}},mounted(){this.init();const t=document.querySelector(".jsoneditor-menu .jsoneditor-poweredBy");this.hasLogo=t&&window.getComputedStyle(t).display!=="none",this.showFullScreen=!0},unmounted(){var t;(t=this.editor)==null||t.destroy(),this.editor=null},methods:{toggleFullScreen(){this.isFullScreen=!this.isFullScreen,this.$nextTick(()=>{const t=new Event("resize");window.dispatchEvent(t)})},init(){const{currentMode:t,modeList:a,options:o}=this,c=()=>{const s=e=>{this.json=e,this.$emit("update:modelValue",e),this.$emit("change",e),this.internalChange=!0,this.$nextTick(()=>{this.internalChange=!1})};if(!this.editor.getText()){s({});return}try{const e=this.editor.get();s(e)}catch{}},n=()=>{this.expandAll()},l=(s,u,e)=>{this.$emit("textSelectionChange",this.editor,s,u,e)},d=(s,u)=>{this.$emit("selectionChange",this.editor,s,u)},f=(s,u,e)=>{this.$emit("colorPicker",this.editor,s,u,e)},v=({target:s})=>{this.$emit("focus",this.editor,s)},S=async({target:s})=>{this.$emit("blur",this.editor,s)},x={...o,indentation:2,language:this.language,mode:t,modes:a,onChange:c,onModeChange:n,onTextSelectionChange:l,onSelectionChange:d,onColorPicker:f,onFocus:v,onBlur:S};this.editor=new J(this.$refs.jsonEditorVue,x,this.json)},expandAll(){var t,a;this.expandedModes.includes((t=this.editor)==null?void 0:t.getMode())&&((a=this.editor)==null||a.expandAll())},setEditorContent(t){var a;(a=this.editor)==null||a.set(t)}}},U={ref:"jsonEditorVue",class:"json-editor-vue"};function q(t,a,o,c,n,l){return E(),$("div",{class:F(["container",{"full-screen-container":n.isFullScreen}])},[p("div",U,null,512),p("div",{class:F(["full-screen",{show:n.showFullScreen,right:!n.hasLogo}]),onClick:a[0]||(a[0]=(...d)=>l.toggleFullScreen&&l.toggleFullScreen(...d))},null,2)],2)}const m=D(A,[["render",q],["__scopeId","data-v-1bb7781c"]]);m.install=function(a){a.component(m.name,m)};typeof window<"u"&&window.Vue&&window.Vue.component(m.name,m);const P=t=>(L("data-v-5b8c1dbb"),t=t(),O(),t),z={class:"setting-container"},G={class:"setting-header"},H=P(()=>p("h1",{class:"setting-title"},"âš™ï¸ æ•°æ®ç®¡ç†",-1)),W={class:"editor-wrapper"},Q={class:"editor-actions"},R={__name:"setting",setup(t){const a=y("daluan"),o=y([]),c=y(!1),n=y(!1),l=K(()=>window.location.pathname.startsWith("/Joker/")),d=()=>a.value==="daluan"?"data_daluan":"data_xiangqi",f=()=>a.value==="daluan"?"/data.json":"/data2.json",v=async()=>{n.value=!0;try{const e=d(),i=localStorage.getItem(e);if(i)o.value=JSON.parse(i),r.success("æ•°æ®åŠ è½½æˆåŠŸï¼ˆå·²ä¿®æ”¹ï¼‰");else{const h=f(),_=await V.get(h+"?t="+Date.now());o.value=_.data.list,r.success("æ•°æ®åŠ è½½æˆåŠŸï¼ˆåˆå§‹æ•°æ®ï¼‰")}}catch(e){r.error("æ•°æ®åŠ è½½å¤±è´¥: "+e.message),console.error("åŠ è½½æ•°æ®å¤±è´¥:",e)}finally{n.value=!1}},S=async()=>{if(l.value){c.value=!0;try{const e=d();localStorage.setItem(e,JSON.stringify(o.value)),window.dispatchEvent(new CustomEvent("dataUpdated",{detail:{type:a.value,data:o.value}})),r.success("æ•°æ®å·²ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨")}catch(e){r.error("ä¿å­˜å¤±è´¥: "+e.message)}finally{c.value=!1}return}c.value=!0;try{const e=a.value==="daluan"?"data.json":"data2.json",h=!1?`http://localhost:3001/api/${e}`:`/api/${e}`;await V.put(h,{list:o.value});const _=d();localStorage.setItem(_,JSON.stringify(o.value)),window.dispatchEvent(new CustomEvent("dataUpdated",{detail:{type:a.value,data:o.value}})),r.success("æ•°æ®ä¿å­˜æˆåŠŸï¼å·²åŒæ­¥åˆ°æ–‡ä»¶ç³»ç»Ÿ")}catch(e){r.error("æ•°æ®ä¿å­˜å¤±è´¥: "+e.message),console.error("ä¿å­˜æ•°æ®å¤±è´¥:",e)}finally{c.value=!1}},x=()=>{v()},s=async()=>{n.value=!0;try{const e=d();localStorage.removeItem(e);const i=f(),h=await V.get(i+"?t="+Date.now());o.value=h.data.list,r.success("å·²é‡ç½®ä¸ºåŽŸå§‹æ•°æ®")}catch(e){r.error("é‡ç½®å¤±è´¥: "+e.message),console.error("é‡ç½®æ•°æ®å¤±è´¥:",e)}finally{n.value=!1}},u=()=>{v()};return T(()=>{v()}),(e,i)=>{const h=w("a-tab-pane"),_=w("a-tabs"),C=w("a-button"),I=w("a-alert");return E(),$("div",z,[p("div",G,[H,g(_,{activeKey:a.value,"onUpdate:activeKey":i[0]||(i[0]=j=>a.value=j),onChange:u,class:"data-tabs"},{default:b(()=>[g(h,{key:"daluan",tab:"ðŸŽ® å¤§ä¹±æ–—æ•°æ®"}),g(h,{key:"xiangqi",tab:"â™Ÿï¸ ä¸‹æ£‹æ•°æ®"})]),_:1},8,["activeKey"])]),p("div",W,[p("div",Q,[g(C,{type:"primary",onClick:S,loading:c.value,disabled:l.value},{default:b(()=>[k(" ðŸ’¾ ä¿å­˜æ•°æ® ")]),_:1},8,["loading","disabled"]),g(C,{onClick:x,loading:n.value},{default:b(()=>[k(" ðŸ”„ é‡æ–°åŠ è½½ ")]),_:1},8,["loading"]),g(C,{danger:"",onClick:s,loading:n.value,disabled:l.value},{default:b(()=>[k(" ðŸ”™ é‡ç½®ä¸ºåŽŸå§‹æ•°æ® ")]),_:1},8,["loading","disabled"])]),l.value?(E(),M(I,{key:0,type:"warning",message:"GitHub Pages éƒ¨ç½²ç‰ˆæœ¬",description:"å½“å‰ä¸ºé™æ€éƒ¨ç½²ç‰ˆæœ¬ï¼Œæ•°æ®ä¿®æ”¹ä»…ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œä¸ä¼šåŒæ­¥åˆ°æœåŠ¡å™¨ã€‚å»ºè®®ä½¿ç”¨æœ¬åœ°éƒ¨ç½²ç‰ˆæœ¬ä»¥èŽ·å¾—å®Œæ•´åŠŸèƒ½ã€‚","show-icon":"",closable:"",style:{"margin-bottom":"16px"}})):N("",!0),g(B(m),{modelValue:o.value,"onUpdate:modelValue":i[1]||(i[1]=j=>o.value=j),class:"editor"},null,8,["modelValue"])])])}}},ee=D(R,[["__scopeId","data-v-5b8c1dbb"]]);export{ee as default};
